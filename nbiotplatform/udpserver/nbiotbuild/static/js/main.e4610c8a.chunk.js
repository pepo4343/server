(this.webpackJsonpnbiotdashboard=this.webpackJsonpnbiotdashboard||[]).push([[0],{131:function(t,e,a){t.exports=a(191)},136:function(t,e,a){},137:function(t,e,a){t.exports=a.p+"static/media/logo.5d5d9eef.svg"},138:function(t,e,a){},139:function(t,e,a){},167:function(t,e){},170:function(t,e,a){t.exports={test:"Map_test__3RFCo"}},191:function(t,e,a){"use strict";a.r(e);var n,r=a(0),i=a.n(r),o=a(74),l=a.n(o),s=(a(136),a(12)),c=a(3),d=(a(137),a(138),a(81)),u=a(75),g=a.n(u),h=a(1),f=h.p("%H:%M:%S"),p=function(t){var e=Object(r.useState)(!1),a=Object(c.a)(e,2),n=a[0],o=a[1],l=Object(r.useState)(!0),u=Object(c.a)(l,2),p=u[0],m=u[1],v=Object(r.useState)(0),x=Object(c.a)(v,2),w=(x[0],x[1],t.data);Object(r.useEffect)((function(){n?0!=w.length&&E("line1",w,t.width,t.height,t.padding):(y(w,t.width,t.height,t.padding),o(!0))}),[w]);var y=function(e,a,n,r){var i=h.o("svg"),o=h.n().domain([h.j(e,(function(t){return t.date})),h.i(e,(function(t){return t.date}))]).range([r,a-r]),l=h.m().domain([0,h.i(e,(function(t){return t.val}))]).range([n-r,r]),s=h.b(o).tickFormat(f),c=h.c(l);i.append("defs").append("clipPath").attr("id","clip").append("rect").attr("transform","translate("+r+","+-r+")").attr("height",t.height),i.append("g").attr("class","x-axis").attr("transform","translate(0,"+(n-r)+")").call(s).transition().duration(1e3),i.append("g").attr("transform","translate("+r+",0)").attr("class","y-axis").call(c).transition().duration(1e3),b("line1",i,e,o,l,"red"),b("line2",i,e,o,l,"blue"),b("line3",i,e,o,l,"green")},b=function(t,e,a,n,r,i){var o=h.h().x((function(t){return n(t.date)})).y((function(t){return r(t.val)}));e.append("g").attr("clip-path","url(#clip)").append("path").attr("class",t).datum(a).attr("fill","none").attr("stroke",i).attr("stroke-width",2).attr("d",o)},E=function(e,a,n,r,i){if(!(a.length<3)){var o=Object(s.a)(a);o.shift();var l=h.n().domain([h.j(o,(function(t){return t.date})),h.i(o,(function(t){return t.date}))]).range([i,n-i]),c=l(a[2].date)-l(a[1].date),u=(h.o("#clip rect").attr("width",t.width-i-i+1),h.n().domain([h.j(a,(function(t){return t.date})),h.i(a,(function(t){return t.date}))]).range([i,n-i+c])),g=h.m().domain([0,h.i(a,(function(t){var e=Object(d.a)({},t);e.date=0;var a=Object.values(e);return Math.max.apply(Math,Object(s.a)(a))}))]).range([r-i,i]),v=h.b(l).ticks(5).tickFormat(f),x=h.c(g).ticks(12),w=h.h().x((function(t){return u(t.date)})).y((function(t){return g(t.val1)}));h.o(".x-axis").transition().duration(1e3).call(v),h.o(".y-axis").transition().duration(1e3).call(x);var y=h.o("."+e).datum(a).attr("d",w),b=y.node().getTotalLength();p?(y.attr("stroke-dasharray",b+" "+b).attr("stroke-dashoffset",b).attr("transform","translate("+-c+",0)").transition().duration(2e3).attr("stroke-dashoffset",0),m(!1)):y.attr("stroke-dasharray",null).attr("stroke-dashoffset",null).attr("transform","translate(0,0)").transition().duration(1e3).attr("transform","translate("+-c+",0)").attr("stroke-dashoffset",0);var E=h.h().x((function(t){return u(t.date)})).y((function(t){return g(t.val2)})),k=h.o(".line2").datum(a).attr("d",E),j=k.node().getTotalLength();p?(k.attr("stroke-dasharray",j+" "+j).attr("stroke-dashoffset",j).attr("transform","translate("+-c+",0)").transition().duration(2e3).attr("stroke-dashoffset",0),m(!1)):k.attr("stroke-dasharray",null).attr("stroke-dashoffset",null).attr("transform","translate(0,0)").transition().duration(1e3).attr("transform","translate("+-c+",0)").attr("stroke-dashoffset",0);var O=h.h().x((function(t){return u(t.date)})).y((function(t){return g(t.val3)})),L=h.o(".line3").datum(a).attr("d",O),M=L.node().getTotalLength();p?(L.attr("stroke-dasharray",M+" "+M).attr("stroke-dashoffset",M).attr("transform","translate("+-c+",0)").transition().duration(2e3).attr("stroke-dashoffset",0),m(!1)):L.attr("stroke-dasharray",null).attr("stroke-dashoffset",null).attr("transform","translate(0,0)").transition().duration(1e3).attr("transform","translate("+-c+",0)").attr("stroke-dashoffset",0)}};return i.a.createElement("div",{id:"line_chart",className:g.a.LineChart},i.a.createElement("svg",{width:t.width,height:t.height,padding:t.padding}))},m=a(76),v=a.n(m),x=function(t){return i.a.createElement("div",{className:v.a.Card,style:{width:t.width}},t.children)},w=(a(139),function(t){var e=t.data,a=Object(r.useState)(null),n=Object(c.a)(a,2),o=n[0],l=n[1],s=function(t,e){var a={},n={size:710,clipWidth:200,clipHeight:110,ringInset:20,ringWidth:20,pointerWidth:10,pointerTailLength:5,pointerHeadLengthPercent:.9,minValue:0,maxValue:40,minAngle:-90,maxAngle:90,transitionMs:750,majorTicks:5,labelFormat:h.f("d"),labelInset:10,arcColorFn:h.m().domain([0,.5,1]).range(["#1a9850","#fee08b","#d73027"]).interpolate(h.g)},r=void 0,i=void 0,o=void 0,l=void 0,s=void 0,c=void 0,d=void 0,u=void 0;h.k();function g(t){return t*Math.PI/180}var f=[0,10,20,30,40,50,60,70,80];function p(t){var e=void 0;for(e in t)n[e]=t[e];r=n.maxAngle-n.minAngle,i=n.size/2,o=Math.round(i*n.pointerHeadLengthPercent);var a=h.m().range([0,1]).domain([0,10]);c=function(t){for(var e=f.length,a=f.length-1;a>=0&&(e=a,!(t>=f[a]));a--);var r=f[e],i=f[f.length-1];return t<f[f.length-1]&&(i=f[e+1]),h.m().range([e*(1/n.majorTicks),(e+1)*(1/n.majorTicks)]).domain([r,i])(t)},a.ticks(n.majorTicks),d=h.l(n.majorTicks).map((function(){return 1/n.majorTicks})),s=h.a().innerRadius(i-n.ringWidth-n.ringInset).outerRadius(i-n.ringInset).startAngle((function(t,e){var a=t*e;return g(n.minAngle+a*r)})).endAngle((function(t,e){var a=t*(e+1);return g(n.minAngle+a*r)}))}function m(t,e){void 0!==e&&p(e);var a=c(t),i=n.minAngle+a*r;u.transition().duration(n.transitionMs).ease(h.e).attr("transform","rotate("+i+")")}return a.configure=p,a.isRendered=function(){return void 0!==l},a.render=function(e){l=h.o(t).append("svg:svg").attr("class","gauge").attr("width",n.clipWidth).attr("height",n.clipHeight);var a="translate("+i+","+i+")";l.append("g").attr("class","arc").attr("transform",a).selectAll("path").data(d).enter().append("path").attr("fill",(function(t,e){return n.arcColorFn(t*e)})).attr("d",s),l.append("g").attr("class","label").attr("transform",a).selectAll("text").data(f).enter().append("text").attr("transform",(function(t,e){var a=e/n.majorTicks;return"rotate("+(n.minAngle+a*r)+") translate(0,"+(n.labelInset-i)+")"})).text(n.labelFormat);var c=[[n.pointerWidth/2,0],[0,-o],[-n.pointerWidth/2,0],[0,n.pointerTailLength],[n.pointerWidth/2,0]],g=h.h().curve(h.d),p=l.append("g").data([c]).attr("class","pointer").attr("transform",a);u=p.append("path").attr("d",g).attr("transform","rotate("+n.minAngle+")"),m(void 0===e?0:e)},a.update=m,p(e),a};return Object(r.useEffect)((function(){o||l(s("#"+t.gauge_id,{size:250,clipWidth:250,clipHeight:180,ringWidth:50,maxValue:60,transitionMs:2e3,majorTicks:8}))}),[]),Object(r.useEffect)((function(){o&&(console.log(o.isRendered()),o.isRendered()||(o.render(),o.update(e)),console.log(e),o.update(e))}),[o,e]),i.a.createElement("div",{id:t.gauge_id})}),y=a(77),b=a.n(y),E=(a(170),a(78)),k=a.n(E),j=a(79),O=a.n(j),L=function(t){var e=Object(r.useRef)(null),a=t.data,n=Object(r.useState)(null),o=Object(c.a)(n,2),l=o[0],s=o[1],d=Object(r.useState)(null),u=Object(c.a)(d,2),g=u[0],f=u[1];return Object(r.useEffect)((function(){s(new window.google.maps.Map(e.current,{center:{lat:13.741307,lng:100.533518},zoom:16})),f(new window.google.maps.OverlayView)}),[]),Object(r.useEffect)((function(){if(e&&l&&g&&0!=a.length){var t=[[[13.735406,100.531831],[13.734605,100.531697],[13.734195,100.534123],[13.745312,100.535775],[13.746148,100.530848],[13.739681,100.529821],[13.739176,100.532807],[13.73903,100.533089],[13.73891,100.533204],[13.737891,100.533061],[13.737417,100.532536],[13.737479,100.532073],[13.735406,100.531831]]];if(h.o("text.textvelo").select("tspan.velo").empty()){var n=h.o("text.textvelo");n.append("tspan").attr("class","velo").text(a[0].v).style("font-size",32).style("font-weight",600).attr("fill","white"),n.append("tspan").style("font-size",18).style("font-weight",400).attr("fill","white").text(" km/hr")}else h.o("text.textvelo").select("tspan.velo").text(a[0].v);g.setMap(null),g.onAdd=function(){var n=!0,r=!0,i=!0;if(h.o(e.current).select("svg").empty())var o=h.o(e.current).append("svg").attr("width",e.current.offsetWidth).attr("height",e.current.offsetHeight).style("top",0).style("left",0).style("position","absolute").style("pointer-events","none");else o=h.o(e.current).select("svg");g.draw=function(){var e=this.getProjection();o.selectAll("path.route").data(t).each(l).enter().append("path").each(l).attr("stroke","#f06eaa").attr("stroke-width","4").attr("fill","none").attr("class","route"),o.selectAll("image.marker").data(a).each(s).enter().append("svg:image").each(s).attr("xlink:href",k.a).attr("width",40).attr("height",40).attr("class","marker"),o.selectAll("image.velocitywrapper").data(a).each(c).enter().append("svg:image").each(c).attr("xlink:href",O.a).attr("width",120).attr("class","velocitywrapper"),o.selectAll("text").data(a).each(d).enter().append("text").attr("class","textvelo").each(d);function l(t){var a="";for(var n in t){var r=new window.google.maps.LatLng(t[n][0],t[n][1]),i=e.fromLatLngToContainerPixel(r),o=i.x,l=i.y;0!=n?a+="L"+o+","+l+" ":a+="M"+o+","+l+" "}return h.o(this).attr("d",a)}function s(t){return t=new window.google.maps.LatLng(t.lat,t.lng),t=e.fromLatLngToContainerPixel(t),n?(n=!1,h.o(this).transition().duration(1e3).attr("x",t.x-20+"px").attr("y",t.y-20+"px")):h.o(this).attr("x",t.x-20+"px").attr("y",t.y-20+"px")}function c(t){return t=new window.google.maps.LatLng(t.lat,t.lng),t=e.fromLatLngToContainerPixel(t),r?(r=!1,h.o(this).transition().duration(1e3).attr("x",t.x+"px").attr("y",t.y-120+5+"px")):h.o(this).attr("x",t.x+"px").attr("y",t.y-120+5+"px")}function d(t){var a=new window.google.maps.LatLng(t.lat,t.lng);return a=e.fromLatLngToContainerPixel(a),i?(i=!1,h.o(this).transition().duration(1e3).attr("x",a.x+5+"px").attr("y",a.y-120+30+18+"px")):h.o(this).attr("x",a.x+5+"px").attr("y",a.y-120+30+18+"px")}}},g.onRemove=function(){console.log("removing")},g.setMap(l)}}),[a,l,g]),i.a.createElement("div",{ref:e,style:{width:"100%",height:"100%"}})},M=a(80);h.q("%m/%d/%Y %H:%M:%S"),h.p("%Y");var P=function(){var t=this,e=Object(r.useState)([]),a=Object(c.a)(e,2),o=a[0],l=a[1],d=Object(r.useState)([]),u=Object(c.a)(d,2),g=u[0],h=u[1],f=Object(r.useState)([]),m=Object(c.a)(f,2),v=m[0],y=m[1];return Object(r.useEffect)((function(){var e=(n=b()("http://178.128.16.9/")).connect();n.on("connect",(function(){console.log("check",e.connected)})),n.on("disconnect",(function(){console.log("check",e.connected)})),n.on("numclient",(function(t){console.log(t)}));var a=[],r=0,i=0;n.on("message",(function(e){try{var n=JSON.parse(e.msg),s=n.Lat,c=n.Lng,d=n.dev_id;if(console.log(d),"0001"!=d)return;console.log(s),console.log(c),console.log(Date.now()),0!=r&&(3==a.length&&a.shift(),a.push(Object(M.getDistance)(r,{latitude:s,longitude:c},.01)/(Date.now()-i)*5/18*1e3),console.log(a));r={latitude:s,longitude:c},i=Date.now(),h([{lat:s,lng:c,v:Math.round((u=a,u.reduce((function(t,e){return t+e}),0)/u.length))}]),y([n.PM1_0,n.PM2_5,n.PM10_0]),l(o.bind(t,n))}catch(g){return void console.log(g)}var u})),h([{lat:13.740766,lng:100.535039,v:100}]);var o=function(t,e){var a=Object(s.a)(e);return e.length<10?a.push({val1:t.PM1_0,val2:t.PM2_5,val3:t.PM10_0,date:Date.now()}):(a.push({val1:t.PM1_0,val2:t.PM2_5,val3:t.PM10_0,date:Date.now()}),a.shift()),a}}),[]),i.a.createElement("div",{className:"App"},i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("h1",{style:{fontSize:80,marginTop:5,marginBottom:5,marginLeft:20,color:"white"}},"NB-",i.a.createElement("span",{style:{fontWeight:400}},"IoT"))),i.a.createElement(x,{width:900},i.a.createElement("h2",null,"PM chart"),i.a.createElement(p,{data:o,width:800,height:400,padding:50}),i.a.createElement("div",{className:"legends-container"},i.a.createElement("div",{className:"legend-container"},i.a.createElement("div",{style:{borderTop:"solid 3px red",width:25,marginRight:5}}),i.a.createElement("p",{style:{margin:0}},"PM 1")),i.a.createElement("div",{className:"legend-container"},i.a.createElement("div",{style:{borderTop:"solid 3px blue",width:25,marginRight:5}}),i.a.createElement("p",{style:{margin:0}},"PM 2.5")),i.a.createElement("div",{className:"legend-container"},i.a.createElement("div",{style:{borderTop:"solid 3px green",width:25,marginRight:5}}),i.a.createElement("p",{style:{margin:0}},"PM 10")))),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(x,{width:287},i.a.createElement("h2",null,"PM 1"),i.a.createElement(w,{gauge_id:"pm1",data:v[0]}),i.a.createElement("h1",{style:{margin:0,top:-30,position:"relative",fontSize:50}},v[0],i.a.createElement("span",{style:{fontSize:30}}," ","\xb5g/m",i.a.createElement("sup",null,"3")))),i.a.createElement(x,{width:287},i.a.createElement("h2",null,"PM 2.5"),i.a.createElement(w,{gauge_id:"pm25",data:v[1]}),i.a.createElement("h1",{style:{margin:0,top:-30,position:"relative",fontSize:50}},v[1],i.a.createElement("span",{style:{fontSize:30}}," ","\xb5g/m",i.a.createElement("sup",null,"3")))),i.a.createElement(x,{width:287},i.a.createElement("h2",null,"PM 10"),i.a.createElement(w,{gauge_id:"pm10",data:v[2]}),i.a.createElement("h1",{style:{margin:0,top:-30,position:"relative",fontSize:50}},v[2],i.a.createElement("span",{style:{fontSize:30}}," ","\xb5g/m",i.a.createElement("sup",null,"3")))))),i.a.createElement(x,{width:900},i.a.createElement(L,{data:g})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},75:function(t,e,a){t.exports={LineChart:"LineChart_LineChart__2Aieq"}},76:function(t,e,a){t.exports={Card:"Card_Card__nPa-c"}},78:function(t,e,a){t.exports=a.p+"static/media/bus.e99f54e5.png"},79:function(t,e,a){t.exports=a.p+"static/media/dialog.ae72a2c4.png"}},[[131,1,2]]]);
//# sourceMappingURL=main.e4610c8a.chunk.js.map